# IBLT-Stress: Predicting Stress From Text

## Introduction
In this project, we develop a stress detection system that leverages machine learning techniques within an instance-based learning framework to provide users with accurate and personalized stress assessments based on their textual input. The system operates by first processing the user's text corpus through a pretrained Support Vector Machine (SVM) model, SVMt, which converts words into a vector of probabilities representing various emotions, denoted as Pe. Subsequently, Pe is utilized by another pretrained SVM model, SVMe, to predict the probabilistic stress level, referred to as Sp. Concurrently, a k-Nearest Neighbors (kNN) model operates in parallel with SVMe, storing Pe exclusively from the user's input. If the kNN model gathers sufficient Pe from the user input to generate a stress level prediction, its output is also considered. Given the potential for conflicting results between SVMt and kNN, a decision-making entity known as the Judge is employed to determine the most appropriate stress level output.

Furthermore, the system incorporates a user-feedback mechanism wherein users can provide their perceived stress level, denoted as deterministic stress or Sd. The Judge utilizes this user-provided Sd as ground truth and recalibrates the data of Pe and Sp accordingly before integrating it into the kNN knowledge base.

## Base Knowledge (Pre-trained Model)
![Base knowledge](https://github.com/notaaronkuo/iblt-stress/blob/main/resources/pretrained-model-diagram.png?raw=true)


<sub>Figure 1: The pre-trained moddels, which are the text-converting SVM (SVMt) and the emotion-converting SVM (SVMe), are trained in parallel with the GoEmotions dataset.</sub>


The intent of the pre trained model is to provide a base knowledge for the system to start with. Eventually the lazy learning model, the kNN, will provide personalized information necessary to provide a more informed result.
The pre-trained SVM models utilized in this project leverage the GoEmotions dataset, which associates words with specific emotions. The SVMt model uses this to train to convert textual inputs into emotion probability vectors (Pe). Additionally, a baseline emotion-to-stress mapping of weights is established and utilized to train the SVMe model. By mapping emotions to stress levels, SVMe provides a crucial link between the emotional context inferred from the text and the ultimate stress level prediction.

## Instance Based Learning Loop
![The IBLT loop outlines the overarching agents that work together to reach a prediction.](https://raw.githubusercontent.com/notaaronkuo/iblt-stress/main/resources/IBLT-loop-diagram.png?token=GHSAT0AAAAAACRWSVBIJMHA4LGY4SFMKLL2ZRRWM6A)


<sub>Figure 2: The IBLT loop outlines the overarching agents that work together to reach a prediction. </sub>


The stress detection system begins by receiving user text input, which is then processed to produce Sp. Initially, the text is converted into a vector of Pe through the SVMt model, establishing the emotional context of the input. Subsequently, both the kNN and SVMe models utilize Pe as input to generate their respective stress predictions. In the case where user data is insufficient for outputting Sp from kNN, the SVMe output by default.

## Judge
![Judge diagram](https://github.com/notaaronkuo/iblt-stress/blob/main/resources/judge-diagram.png?raw=true)


<sub>Figure 3: The judge decides what the stress reported by the system is after evaluating the SVMe and kNN.</sub>



The Judge component determines the final stress level output in our system. It evaluates the Sp generated by both the SVMe and kNN models using an approach of heuristics. In the normal case where SVMe and kNN produce identical stress levels, the Judge simply selects and utilizes this shared Sp value. However, in instances where SVMe and kNN outputs diverge, the Judge employs a decision-making process. If the discrepancy is minor and the kNN-generated Sp is relatively close to that of SVMe, the Judge opts for the kNN Sp. Conversely, if the discrepancy is significant, the Judge favors the SVMe. Additionally, when users provide their perceived stress level (Sd), the Judge compares it with the system-generated Sp and stress values obtained from other sources. Based on this comparison, the Judge determines which value is more likely to be accurate.

## Installation
To set up IBLT-Stress, follow these steps:
1. Clone the repository
2. Install the dependencies provided.
3. Run main.py to run mock user tests.
